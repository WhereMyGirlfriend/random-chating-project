<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Í≤åÏûÑ Ï±ÑÌåÖ Î°úÎπÑ</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      color: #333;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }

    .header {
      text-align: center;
      color: white;
      margin-bottom: 40px;
      position: relative;
    }

    .header h1 {
      font-size: 48px;
      font-weight: 700;
      margin-bottom: 10px;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    }

    .header p {
      font-size: 18px;
      opacity: 0.9;
      font-weight: 300;
    }

    .user-info {
      position: absolute;
      top: 0;
      right: 0;
      background: rgba(255,255,255,0.15);
      padding: 12px 20px;
      border-radius: 30px;
      backdrop-filter: blur(10px);
      display: flex;
      align-items: center;
      gap: 12px;
      border: 1px solid rgba(255,255,255,0.2);
    }

    .user-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: linear-gradient(45deg, #4CAF50, #45a049);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: bold;
      font-size: 16px;
    }

    .user-name {
      font-weight: 500;
      font-size: 14px;
    }

    .logout-btn {
      background: rgba(255,255,255,0.2);
      color: white;
      border: none;
      padding: 6px 12px;
      border-radius: 20px;
      cursor: pointer;
      font-size: 12px;
      font-weight: 500;
      transition: all 0.3s ease;
      border: 1px solid rgba(255,255,255,0.3);
    }

    .logout-btn:hover {
      background: rgba(255,255,255,0.3);
      transform: translateY(-1px);
    }

    .main-content {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 30px;
      align-items: start;
    }

    .section-card {
      background: rgba(255,255,255,0.95);
      border-radius: 20px;
      padding: 30px;
      box-shadow: 0 20px 40px rgba(0,0,0,0.1);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255,255,255,0.2);
      transition: transform 0.3s ease;
    }

    .section-card:hover {
      transform: translateY(-5px);
    }

    .section-title {
      font-size: 24px;
      font-weight: 700;
      color: #333;
      margin-bottom: 20px;
      text-align: center;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }

    .create-form {
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .form-group {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .form-label {
      font-weight: 600;
      color: #555;
      font-size: 14px;
    }

    .form-input {
      padding: 15px 20px;
      border: 2px solid #e1e5e9;
      border-radius: 12px;
      font-size: 16px;
      transition: all 0.3s ease;
      background: rgba(248,249,250,0.8);
      font-family: inherit;
    }

    .form-input:focus {
      outline: none;
      border-color: #667eea;
      background: white;
      box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.1);
      transform: translateY(-1px);
    }

    .create-btn {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      padding: 16px 24px;
      border-radius: 12px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      font-family: inherit;
      position: relative;
      overflow: hidden;
    }

    .create-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
      transition: left 0.5s;
    }

    .create-btn:hover::before {
      left: 100%;
    }

    .create-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
    }

    .create-btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }

    .create-btn:disabled::before {
      display: none;
    }

    .room-list-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 20px;
    }

    .refresh-btn {
      background: #28a745;
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .refresh-btn:hover {
      background: #218838;
      transform: scale(1.05);
    }

    .room-list {
      max-height: 500px;
      overflow-y: auto;
      padding-right: 5px;
    }

    .room-list::-webkit-scrollbar {
      width: 6px;
    }

    .room-list::-webkit-scrollbar-track {
      background: rgba(241,241,241,0.5);
      border-radius: 10px;
    }

    .room-list::-webkit-scrollbar-thumb {
      background: rgba(193,193,193,0.8);
      border-radius: 10px;
    }

    .room-list::-webkit-scrollbar-thumb:hover {
      background: rgba(154,154,154,0.8);
    }

    .room-item {
      background: linear-gradient(135deg, rgba(248,249,250,0.9) 0%, rgba(233,236,239,0.9) 100%);
      border: 2px solid transparent;
      border-radius: 16px;
      padding: 20px;
      margin-bottom: 15px;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .room-item::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(102, 126, 234, 0.1), transparent);
      transition: left 0.5s;
    }

    .room-item:hover::before {
      left: 100%;
    }

    .room-item:hover {
      border-color: #667eea;
      transform: translateY(-3px);
      box-shadow: 0 10px 30px rgba(102, 126, 234, 0.2);
      background: white;
    }

    .room-name {
      font-size: 18px;
      font-weight: 700;
      color: #333;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .room-info {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
    }

    .room-creator {
      color: #666;
      font-size: 14px;
      font-weight: 500;
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .room-players {
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 600;
    }

    .room-time {
      color: #999;
      font-size: 12px;
      text-align: right;
      font-weight: 400;
    }

    .empty-state {
      text-align: center;
      color: #999;
      padding: 60px 20px;
      font-style: italic;
    }

    .empty-state-icon {
      font-size: 48px;
      margin-bottom: 15px;
      opacity: 0.5;
    }

    .loading {
      display: none;
      text-align: center;
      padding: 20px;
      color: #666;
    }

    .spinner {
      border: 3px solid rgba(102, 126, 234, 0.3);
      border-top: 3px solid #667eea;
      border-radius: 50%;
      width: 30px;
      height: 30px;
      animation: spin 1s linear infinite;
      margin: 0 auto 10px;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .notification {
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 16px 24px;
      border-radius: 12px;
      color: white;
      font-weight: 600;
      z-index: 1001;
      transform: translateX(400px);
      transition: all 0.3s ease;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
      backdrop-filter: blur(10px);
    }

    .notification.show {
      transform: translateX(0);
    }

    .notification.success {
      background: linear-gradient(135deg, #28a745, #20c997);
    }

    .notification.error {
      background: linear-gradient(135deg, #dc3545, #fd7e14);
    }

    .stats-bar {
      background: rgba(255,255,255,0.1);
      padding: 10px 20px;
      border-radius: 12px;
      margin-bottom: 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 14px;
      color: white;
    }

    .stats-item {
      display: flex;
      align-items: center;
      gap: 5px;
    }

    @media (max-width: 768px) {
      .container {
        padding: 15px;
      }

      .main-content {
        grid-template-columns: 1fr;
        gap: 20px;
      }

      .header h1 {
        font-size: 36px;
      }

      .section-card {
        padding: 20px;
      }

      .user-info {
        position: relative;
        margin-bottom: 20px;
        justify-self: center;
      }

      .room-item {
        padding: 15px;
      }
    }

    @media (max-width: 480px) {
      .header h1 {
        font-size: 28px;
      }

      .user-info {
        flex-direction: column;
        gap: 8px;
        text-align: center;
      }
    }
  </style>
</head>
<body>
<div class="container">
  <div class="header">
    <div class="user-info">
      <div class="user-avatar" id="userAvatar">U</div>
      <span class="user-name" id="currentUser">Î°úÎî©Ï§ë...</span>
      <button class="logout-btn" onclick="logout()">Î°úÍ∑∏ÏïÑÏõÉ</button>
    </div>
    <h1>üéÆ Í≤åÏûÑ Ï±ÑÌåÖ Î°úÎπÑ</h1>
    <p>ÏõêÌïòÎäî Í≤åÏûÑÎ∞©ÏùÑ ÎßåÎì§Í±∞ÎÇò Ï∞∏Í∞ÄÌï¥Î≥¥ÏÑ∏Ïöî!</p>
  </div>

  <div class="stats-bar">
    <div class="stats-item">
      <span>üè†</span>
      <span id="totalRooms">0Í∞ú Î∞©</span>
    </div>
    <div class="stats-item">
      <span>üë•</span>
      <span id="totalUsers">0Î™Ö Ï†ëÏÜç</span>
    </div>
    <div class="stats-item">
      <span>üîÑ</span>
      <span>Ïã§ÏãúÍ∞Ñ ÏóÖÎç∞Ïù¥Ìä∏</span>
    </div>
  </div>

  <div class="main-content">
    <!-- Î∞© ÏÉùÏÑ± ÏÑπÏÖò -->
    <div class="section-card">
      <h2 class="section-title">
        <span>üèóÔ∏è</span>
        ÏÉà Í≤åÏûÑÎ∞© ÎßåÎì§Í∏∞
      </h2>
      <form id="createRoomForm" class="create-form">
        <div class="form-group">
          <label class="form-label">Í≤åÏûÑ Ïù¥Î¶Ñ</label>
          <input type="text" id="gameName" class="form-input"
                 placeholder="Ïòà: Î¶¨Í∑∏Ïò§Î∏åÎ†àÏ†ÑÎìú, Ïò§Î≤ÑÏõåÏπò, Î∞úÎ°úÎûÄÌä∏"
                 required maxlength="50">
        </div>
        <button type="submit" class="create-btn" id="createBtn">
          Î∞© ÏÉùÏÑ±ÌïòÍ∏∞
        </button>
      </form>
    </div>

    <!-- Î∞© Î™©Î°ù ÏÑπÏÖò -->
    <div class="section-card">
      <div class="room-list-header">
        <h2 class="section-title">
          <span>üè†</span>
          ÌôúÏÑ± Í≤åÏûÑÎ∞©
        </h2>
        <button id="refreshBtn" class="refresh-btn">
          <span>üîÑ</span>
          ÏÉàÎ°úÍ≥†Ïπ®
        </button>
      </div>

      <div class="loading" id="roomListLoading">
        <div class="spinner"></div>
        Î∞© Î™©Î°ùÏùÑ Î∂àÎü¨Ïò§Îäî Ï§ë...
      </div>

      <div id="roomList" class="room-list">
        <div class="empty-state">
          <div class="empty-state-icon">üè†</div>
          ÏïÑÏßÅ ÏÉùÏÑ±Îêú Î∞©Ïù¥ ÏóÜÏäµÎãàÎã§.<br>
          Ï≤´ Î≤àÏß∏ Î∞©ÏùÑ ÎßåÎì§Ïñ¥Î≥¥ÏÑ∏Ïöî!
        </div>
      </div>
    </div>
  </div>
</div>

<!-- ÏïåÎ¶º -->
<div id="notification" class="notification"></div>

<!-- JavaScript ÎùºÏù¥Î∏åÎü¨Î¶¨ -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sockjs-client/1.6.1/sockjs.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js"></script>

<script>
  // Ï†ÑÏó≠ Î≥ÄÏàò
  let stompClient = null;
  let currentUsername = null;
  let authToken = null;

  // DOM ÏöîÏÜåÎì§
  const createRoomForm = document.getElementById('createRoomForm');
  const createBtn = document.getElementById('createBtn');
  const roomList = document.getElementById('roomList');
  const roomListLoading = document.getElementById('roomListLoading');
  const refreshBtn = document.getElementById('refreshBtn');
  const notification = document.getElementById('notification');
  const currentUserEl = document.getElementById('currentUser');
  const userAvatar = document.getElementById('userAvatar');
  const totalRoomsEl = document.getElementById('totalRooms');
  const totalUsersEl = document.getElementById('totalUsers');

  // ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú Ï¥àÍ∏∞Ìôî
  document.addEventListener('DOMContentLoaded', function() {
    checkAuthAndInit();
  });

  // Ïù∏Ï¶ù ÌôïÏù∏ Î∞è Ï¥àÍ∏∞Ìôî
  function checkAuthAndInit() {
    authToken = localStorage.getItem('authToken');

    if (!authToken || !isValidToken(authToken)) {
      window.location.href = '/login';
      return;
    }

    try {
      const payload = JSON.parse(atob(authToken.split('.')[1]));
      currentUsername = payload.sub;

      // UI ÏóÖÎç∞Ïù¥Ìä∏
      currentUserEl.textContent = currentUsername;
      userAvatar.textContent = currentUsername.charAt(0).toUpperCase();

      // Ïï± Ï¥àÍ∏∞Ìôî
      initializeApp();
    } catch (error) {
      console.error('ÌÜ†ÌÅ∞ ÌååÏã± Ïò§Î•ò:', error);
      logout();
    }
  }

  // Ïï± Ï¥àÍ∏∞Ìôî
  function initializeApp() {
    connectWebSocket();
    loadRoomList();
    loadStatistics();
    setupEventListeners();
  }

  // Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà ÏÑ§Ï†ï
  function setupEventListeners() {
    createRoomForm.addEventListener('submit', handleCreateRoom);
    refreshBtn.addEventListener('click', () => {
      loadRoomList();
      loadStatistics();
    });

    // ÏûêÎèô ÏÉàÎ°úÍ≥†Ïπ® (30Ï¥àÎßàÎã§)
    setInterval(() => {
      loadRoomList();
      loadStatistics();
    }, 30000);
  }

  // WebSocket Ïó∞Í≤∞
  function connectWebSocket() {
    try {
      const socket = new SockJS('/ws');
      stompClient = Stomp.over(socket);

      const headers = {
        'Authorization': 'Bearer ' + authToken
      };

      stompClient.connect(headers, function() {
        console.log('WebSocket Ïó∞Í≤∞Îê®');

        // Î∞© Î™©Î°ù ÏóÖÎç∞Ïù¥Ìä∏ Íµ¨ÎèÖ
        stompClient.subscribe('/topic/rooms', function(message) {
          console.log('Î∞© Î™©Î°ù ÏóÖÎç∞Ïù¥Ìä∏ ÏïåÎ¶º Î∞õÏùå');
          loadRoomList();
          loadStatistics();
        });
      }, function(error) {
        console.error('WebSocket Ïó∞Í≤∞ Ïã§Ìå®:', error);
        showNotification('ÏÑúÎ≤Ñ Ïó∞Í≤∞Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.', 'error');
      });
    } catch (error) {
      console.error('WebSocket Ï¥àÍ∏∞Ìôî Ïã§Ìå®:', error);
      showNotification('WebSocket Ï¥àÍ∏∞ÌôîÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.', 'error');
    }
  }

  // Î∞© ÏÉùÏÑ± Ï≤òÎ¶¨
  async function handleCreateRoom(e) {
    e.preventDefault();

    const gameName = document.getElementById('gameName').value.trim();

    if (!gameName) {
      showNotification('Í≤åÏûÑ Ïù¥Î¶ÑÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.', 'error');
      return;
    }

    if (gameName.length < 2) {
      showNotification('Í≤åÏûÑ Ïù¥Î¶ÑÏùÄ 2Í∏ÄÏûê Ïù¥ÏÉÅ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.', 'error');
      return;
    }

    createBtn.disabled = true;
    createBtn.textContent = 'ÏÉùÏÑ± Ï§ë...';

    try {
      const response = await fetch('/api/rooms/create', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': 'Bearer ' + authToken
        },
        body: JSON.stringify({
          gameName: gameName
        })
      });

      const result = await response.json();

      if (response.ok) {
        showNotification('Î∞©Ïù¥ ÏÑ±Í≥µÏ†ÅÏúºÎ°ú ÏÉùÏÑ±ÎêòÏóàÏäµÎãàÎã§!', 'success');
        document.getElementById('gameName').value = '';

        // 1Ï¥à ÌõÑ Î∞©ÏúºÎ°ú Ïù¥Îèô
        setTimeout(() => {
          window.location.href = `/room/${result.roomId}`;
        }, 1000);
      } else {
        if (response.status === 401) {
          logout();
          return;
        }
        showNotification(result.error || 'Î∞© ÏÉùÏÑ±Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.', 'error');
      }
    } catch (error) {
      console.error('Î∞© ÏÉùÏÑ± Ïò§Î•ò:', error);
      showNotification('Î∞© ÏÉùÏÑ± Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.', 'error');
    } finally {
      createBtn.disabled = false;
      createBtn.textContent = 'Î∞© ÏÉùÏÑ±ÌïòÍ∏∞';
    }
  }

  // Î∞© Î™©Î°ù Î°úÎìú
  async function loadRoomList() {
    roomListLoading.style.display = 'block';

    try {
      const response = await fetch('/api/rooms/list', {
        headers: {
          'Authorization': 'Bearer ' + authToken
        }
      });

      if (response.status === 401) {
        logout();
        return;
      }

      const rooms = await response.json();
      renderRoomList(rooms);
    } catch (error) {
      console.error('Î∞© Î™©Î°ù Î°úÎìú Ïò§Î•ò:', error);
      showNotification('Î∞© Î™©Î°ùÏùÑ Î∂àÎü¨Ïò§ÎäîÎç∞ Ïã§Ìå®ÌñàÏäµÎãàÎã§.', 'error');
      renderRoomList([]);
    } finally {
      roomListLoading.style.display = 'none';
    }
  }

  // ÌÜµÍ≥Ñ Ï†ïÎ≥¥ Î°úÎìú
  async function loadStatistics() {
    try {
      const response = await fetch('/api/rooms/statistics', {
        headers: {
          'Authorization': 'Bearer ' + authToken
        }
      });

      if (response.ok) {
        const stats = await response.json();
        totalRoomsEl.textContent = `${stats.totalRooms}Í∞ú Î∞©`;
        totalUsersEl.textContent = `${stats.totalParticipants}Î™Ö Ï†ëÏÜç`;
      }
    } catch (error) {
      console.error('ÌÜµÍ≥Ñ Î°úÎìú Ïò§Î•ò:', error);
    }
  }

  // Î∞© Î™©Î°ù Î†åÎçîÎßÅ
  function renderRoomList(rooms) {
    if (rooms.length === 0) {
      roomList.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">üè†</div>
                        ÏïÑÏßÅ ÏÉùÏÑ±Îêú Î∞©Ïù¥ ÏóÜÏäµÎãàÎã§.<br>
                        Ï≤´ Î≤àÏß∏ Î∞©ÏùÑ ÎßåÎì§Ïñ¥Î≥¥ÏÑ∏Ïöî!
                    </div>
                `;
      return;
    }

    roomList.innerHTML = rooms.map(room => {
      const createdTime = new Date(room.createdAt);
      const timeString = formatTimeAgo(createdTime);

      return `
                    <div class="room-item" onclick="joinRoom('${room.roomId}', '${escapeHtml(room.gameName)}')">
                        <div class="room-name">
                            <span>üéÆ</span>
                            ${escapeHtml(room.gameName)}
                        </div>
                        <div class="room-info">
                            <span class="room-creator">
                                <span>üë§</span>
                                ${escapeHtml(room.creator)}
                            </span>
                            <span class="room-players">${room.currentPlayers}/${room.maxPlayers}Î™Ö</span>
                        </div>
                        <div class="room-time">${timeString}</div>
                    </div>
                `;
    }).join('');
  }

  // Î∞© Ï∞∏Í∞Ä
  function joinRoom(roomId, gameName) {
    window.location.href = `/room/${roomId}`;
  }

  // Î°úÍ∑∏ÏïÑÏõÉ
  function logout() {
    localStorage.removeItem('authToken');
    if (stompClient) {
      stompClient.disconnect();
    }
    window.location.href = '/login';
  }

  // ÏïåÎ¶º ÌëúÏãú
  function showNotification(message, type = 'success') {
    notification.textContent = message;
    notification.className = `notification ${type}`;
    notification.classList.add('show');

    setTimeout(() => {
      notification.classList.remove('show');
    }, 3000);
  }

  // HTML Ïù¥Ïä§ÏºÄÏù¥ÌîÑ
  function escapeHtml(text) {
    const div = document.createElement('div');
    div.textContent = text;
    return div.innerHTML;
  }

  // ÏãúÍ∞Ñ Ìè¨Îß∑ÌåÖ
  function formatTimeAgo(date) {
    const now = new Date();
    const diffMs = now - date;
    const diffMins = Math.floor(diffMs / 60000);
    const diffHours = Math.floor(diffMins / 60);
    const diffDays = Math.floor(diffHours / 24);

    if (diffMins < 1) return 'Î∞©Í∏à Ï†Ñ';
    if (diffMins < 60) return `${diffMins}Î∂Ñ Ï†Ñ`;
    if (diffHours < 24) return `${diffHours}ÏãúÍ∞Ñ Ï†Ñ`;
    if (diffDays < 7) return `${diffDays}Ïùº Ï†Ñ`;

    return date.toLocaleDateString('ko-KR', {
      month: 'short',
      day: 'numeric'
    });
  }

  // ÌÜ†ÌÅ∞ Ïú†Ìö®ÏÑ± ÌôïÏù∏
  function isValidToken(token) {
    if (!token) return false;

    try {
      const parts = token.split('.');
      if (parts.length !== 3) return false;

      const payload = JSON.parse(atob(parts[1]));
      const currentTime = Math.floor(Date.now() / 1000);

      return payload.exp > currentTime;
    } catch (error) {
      return false;
    }
  }

  // ÌÇ§Î≥¥Îìú Îã®Ï∂ïÌÇ§
  document.addEventListener('keydown', function(e) {
    // Ctrl+EnterÎ°ú Î∞© ÏÉùÏÑ±
    if (e.ctrlKey && e.key === 'Enter') {
      e.preventDefault();
      createRoomForm.dispatchEvent(new Event('submit'));
    }

    // F5Î°ú ÏÉàÎ°úÍ≥†Ïπ®
    if (e.key === 'F5') {
      e.preventDefault();
      loadRoomList();
      loadStatistics();
    }
  });
</script>
</body>
</html>